<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ACT Lab Online Consent</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?version=3.52.1&features=URL"></script>
    <style>
      body {
        background-color: #222222;
        font-family: "Arial", Gadget, sans-serif;
        color: #eeeeee;
      }
      a:link {
        color: hotpink;
      }
      h1 {
        font-size: xx-large;
      }
      .button {
        background-color: #4caf50;
        border: none;
        border-radius: 8px;
        color: white;
        padding: 16px 32px;
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin: 4px 2px;
        opacity: 0.9;
        transition: 0.3s;
        display: inline-block;
        text-decoration: none;
        cursor: pointer;
      }
      .button:hover {
        opacity: 1;
      }
    </style>
  </head>

  <body>
    <div align="center">
      <h1>ACT Lab Online Consent</h1>
      <h3>
        Please read the consent form below, and either<br />click the
        <span style="color: #4caf50;">ACCEPT</span> button to
        <span style="color: #4caf50;">continue</span>,<br />
        or <span style="color: #d8565f;">CLOSE</span> the tab to
        <span style="color: #d8565f;">decline</span>.
      </h3>
      <object
        data="./actlab_online_consent.pdf"
        style="width: 70%; height: 72vh;"
        type="application/pdf"
      >
        <h2>Your browser does not support embedded PDFs.</h2>
        <h2>
          Please download the consent form
          <a href="./actlab_online_consent.pdf">here</a><br />and review before
          continuing.
        </h2>
        <embed
          src="./actlab_online_consent.pdf"
          style="width: 70%; height: 75vh;"
          type="application/pdf"
        />
      </object>
      <br />
      <button id="accept" class="button accept">ACCEPT (Will Redirect)</button>
    </div>
    <script type="text/javascript">
      document.getElementById("accept").onclick = function () {
        var url = new URL(window.location.href);
        var next_url = url.searchParams.get("dest");
        if (next_url === null) {
          console.error("URL not specified!");
        } else {
          // try e.g. https://actlabyale.github.io/web-consent?dest=https%3A%2F%2Fgithub.com%2Fsdmcdougle%3Ftab%3Drepositories&prolific=1
          url.searchParams.delete("dest");
          // append parameters to destination URL and go
          var new_url_params = new URL(next_url).searchParams.toString();
          var sep = new_url_params.length > 0 ? "&" : "?";
          var str_args = url.searchParams.toString();
          var final_url = next_url + sep + str_args;
          // TODO: comment this out for the "real deal"
          alert("Navigating to " + final_url);
          // finally redirect to the experiment URL
          window.location.href = final_url;
        }
      };
    </script>
  </body>
</html>
